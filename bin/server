#!/usr/bin/env ruby

require 'bundler/setup'
require 'sinatra'
require 'json'
require_relative '../lib/dsn'

set :bind, ENV.fetch('HOST', '0.0.0.0')
set :port, ENV.fetch('PORT', 3000).to_i
set :public_folder, File.expand_path('../public', __dir__)

get '/api/dsn' do
  content_type :json
  base_url = ENV['BASE_URL'] || request.base_url
  DSN.fetch(base_url: base_url).to_json
end

get '/' do
  'NASA Deep Space Network API. GET /api/dsn for data.'
end

get '/up' do
  'ok'
end
